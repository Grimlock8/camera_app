<span class="error"></span>
<br>
<label for="interval">Time between images in seconds: </label>
<input id="interval" type="text" value="1" min="1" pattern="\d+">
<br>
<button id="start">Start</button>
<br>
<label for="hideVid">Hide video element: </label>
<input id="hideVid" type="checkbox">
<br>
<p>Camera Settings</p>
<span id="settings"></span>
<p>Camera capabilities</p>
<span id="caps"></span>
<br>
<video autoplay muted playsinline></video>
<p>
  Images captured: <span id="image_count">0</span>
</p>
<br>
<button id="stop" disabled>Stop & Show Images</button>
<div id="images"></div>





<script>
 // check for support
    if(typeof ImageCapture === 'undefined'){
        const supportError = "ImageCapture is not supported by your browser";
        const errorSpan = document.querySelector('span.error');
        errorSpan.style = "color:red;font-size:larger;font-weight:bold";
        errorSpan.innerText = supportError;
        console.error(supportError);
    }

    const startBtn = document.querySelector('button#start');
    const stopBtn = document.querySelector('button#stop');
    const hideVid = document.querySelector('input#hideVid')
    const intervalSec = document.querySelector('input#interval');
    const videoElem = document.querySelector('video');
    const imageCountSpan = document.querySelector('span#image_count');
    const settingsSpan = document.querySelector('span#settings');
    const capsSpan = document.querySelector('span#caps');
    const imagesDiv = document.querySelector('div#images');
    const storage = [];     // Use this array as our database
    let stream, captureInterval;

    hideVid.onclick = () => videoElem.hidden = hideVid.checked;


    startBtn.onclick = async () => {
        startBtn.disabled = true;

        stream = await navigator.mediaDevices.getUserMedia({video: true});
        videoElem.onplaying = () => console.log("video playing stream:", videoElem.srcObject);
        videoElem.srcObject = stream;

        const [track] = stream.getVideoTracks();
        const imageCapture = new ImageCapture(track);
        const photoCapabilities = await imageCapture.getPhotoCapabilities();
        capsSpan.innerText = JSON.stringify(photoCapabilities);
        console.log("Photo Capabilities: ", photoCapabilities);
        const photoSettings = await imageCapture.getPhotoSettings();
        settingsSpan.innerText = JSON.stringify(photoSettings);
        console.log("Photo settings: ", photoSettings);

        // (data check on the interval value) * that value is in seconds  * frame timestamps are in microseconds
        const interval = (parseInt(intervalSec.value) >= 1 ? intervalSec.value * 1 : 1) * 1000;
        captureInterval = setInterval(async () => {
            const blob = await imageCapture.takePhoto()
                .catch(err => console.error(err)); // It took a few seconds for me the camera to get ready

            if(blob){
                console.log(blob);
                storage.push(blob);
                imageCountSpan.innerText++;
            }

        }, interval);

        stopBtn.disabled = false;
    }

    stopBtn.onclick = () => {
        // stop capture
        clearInterval(captureInterval);

        // close the camera
        stream.getTracks().forEach(track => track.stop());

        // Display each image
        function showImages() {
            const blob = storage.shift();
            const imageUrl = URL.createObjectURL(blob);
            const imgElem = new Image();
            imgElem.src = imageUrl;
            imagesDiv.appendChild(imgElem);

            if (storage.length > 0)
                showImages();
        }

        console.log("stored images");
        showImages();
    }




<html lang=”en”>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="x-ua-compatible" content="ie=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<meta name="mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="application-name" content="Camera app">
		<meta name="apple-mobile-web-app-title" content="Camera app">

		<!-- Name of the app -->
		<title>Camera App</title>

		<!-- Link to site manifest -->
		<link rel="manifest" href="site.webmanifest">

		<!-- Links to icons -->
		<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
		<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
		<link rel="manifest" href="site.webmanifest">
		<link rel="mask-icon" href="safari-pinned-tab.svg" color="#603cba">
		<meta name="msapplication-TileColor" content="#603cba">
		<meta name="theme-color" content="#ffffff">

		<!-- Link to main style sheet -->
		<link rel="stylesheet" href="style.css"> 
	</head>
	<body>
<div id="container">


    <video id="mmgum-local" autoplay playsinline></video>
    <button id="showVideo">Open camera</button>

        <!-- Camera -->
    <div id="camera">
        <!-- Camera sensor -->
        <canvas id="camera--sensor"></canvas>
        <!-- Camera view -->
        <video id="camera--view" autoplay playsinline></video>
        <!-- Camera output -->
        <img src="//:0" alt="" id="camera--output">
        <!-- Camera trigger -->
        <button download="my-photo.jpg" id="camera--trigger">Take a picture</button>

        <a id="downloadPhoto" download="my-photo.jpg" class="button" role="button">Download</a>
    </div>

    <div id="errorMsg"></div>


</div>

		<!-- Reference to your JavaScript file -->
		<script src="app.js"></script>

		<!-- Reference to adapter.js -->
		<script src="adapter-min.js"></script>

	</body>
</html>
